---
import Layout from "../../layouts/Layout.astro";
import PageHeader from "../../components/PageHeader.jsx";
import { packages } from "../../data/packages";
export async function getStaticPaths() {
    return packages.map((pkg) => ({
        params: { slug: pkg.slug },
        props: { pkg },
    }));
}
import { getImage } from "astro:assets";

const { pkg } = Astro.props;

// Optimize Header Image
const optimizedHeaderImage = await getImage({
    src: pkg.headerImage || pkg.image,
    format: "avif",
    width: 1920,
    quality: 80,
});

// Optimize Itinerary Images
const optimizedItinerary = pkg.itinerary
    ? await Promise.all(
          pkg.itinerary.map(async (item) => {
              if (item.image) {
                  const optimizedItemImage = await getImage({
                      src: item.image,
                      format: "avif",
                      width: 800,
                      quality: 80,
                  });
                  return { ...item, image: optimizedItemImage.src };
              }
              return item;
          }),
      )
    : [];
---

<Layout title={`${pkg.title} | Expeditions Group`}>
    <main class="bg-gray-50 min-h-screen">
        {/* Dynamic Header */}
        <PageHeader
            title={pkg.title}
            subtitle={pkg.description}
            image={optimizedHeaderImage.src}
            client:load
        />
        <div class="relative overflow-hidden">
            {/* Background Decorations */}
            <div
                class="absolute top-0 right-0 -translate-y-1/4 translate-x-1/4 opacity-[0.02] pointer-events-none select-none hidden lg:block"
            >
                <svg
                    width="600"
                    height="600"
                    viewBox="0 0 100 100"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="text-primary"
                >
                    <path
                        d="M0 50L50 0L100 50L50 100L0 50Z"
                        stroke="currentColor"
                        stroke-width="0.5"></path>
                    <path
                        d="M10 50L50 10L90 50L50 90L10 50Z"
                        stroke="currentColor"
                        stroke-width="0.5"></path>
                    <circle
                        cx="50"
                        cy="50"
                        r="40"
                        stroke="currentColor"
                        stroke-width="0.5"></circle>
                    <circle
                        cx="50"
                        cy="50"
                        r="30"
                        stroke="currentColor"
                        stroke-width="0.5"></circle>
                </svg>
            </div>

            <div
                class="absolute bottom-0 left-0 translate-y-1/4 -translate-x-1/4 opacity-[0.04] pointer-events-none select-none hidden lg:block"
            >
                <svg
                    width="500"
                    height="500"
                    viewBox="0 0 100 100"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="text-secondary"
                >
                    <rect
                        x="20"
                        y="20"
                        width="60"
                        height="60"
                        transform="rotate(45 50 50)"
                        stroke="currentColor"
                        stroke-width="0.5"></rect>
                    <rect
                        x="30"
                        y="30"
                        width="40"
                        height="40"
                        transform="rotate(45 50 50)"
                        stroke="currentColor"
                        stroke-width="0.5"></rect>
                    <circle
                        cx="50"
                        cy="50"
                        r="45"
                        stroke="currentColor"
                        stroke-width="0.3"
                        stroke-dasharray="2 2"></circle>
                </svg>
            </div>

            <div
                class="container mx-auto px-4 md:px-8 max-w-7xl py-12 md:py-20 relative z-10"
            >
                <div class="grid grid-cols-1 lg:grid-cols-3
gap-12">
                    {/* Main Content: Itinerary */}
                    <div class="lg:col-span-2 space-y-12">
                        {
                            /*
Intro */
                        }
                        <div
                            class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100"
                        >
                            <h2
                                class="text-3xl font-bold text-slate-800 mb-6 flex items-center gap-3"
                            >
                                <span class="w-2 h-8 bg-secondary rounded-full"
                                ></span> Descripción del Viaje
                            </h2>
                            <p class="text-slate-600 leading-relaxed text-lg">
                                {pkg.description}
                            </p>
                        </div>
                        {
                            /*
Timeline Itinerary */
                        }
                        <div
                            class="bg-white rounded-3xl p-8 md:p-12 shadow-sm border
border-slate-100"
                        >
                            <h2
                                class="text-3xl font-bold text-slate-800 mb-8 flex items-center
gap-3"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-8 w-8 text-secondary"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke="currentColor"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9
7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0121 18.382V7.618a1 1 0 01-1.447-.894L15
7m0 13V7m0 0L9 4"
                                    ></path>
                                </svg> Itinerario Detallado
                            </h2>
                            <div
                                class="relative
pl-4 md:pl-8 border-l-2 border-slate-200 space-y-8 md:space-y-12"
                            >
                                {
                                    pkg.itinerary.map((item: any, index) => (
                                        <div class="relative group">
                                            {" "}
                                            {/* Dot */}{" "}
                                            <div
                                                class="absolute -left-[25px] md:-left-[41px] top-0
w-4 h-4 md:w-6 md:h-6 rounded-full bg-white border-[3px] md:border-4 border-secondary group-hover:scale-110 transition-transform
shadow-sm"
                                            />{" "}
                                            <div
                                                class="bg-slate-50 p-4 md:p-6 rounded-2xl group-hover:bg-white group-hover:shadow-md
transition-all duration-300 border border-transparent group-hover:border-slate-100"
                                            >
                                                <span
                                                    class="inline-block px-3 py-1 bg-secondary/10 text-secondary text-xs md:text-sm font-bold
rounded-full mb-2 md:mb-3"
                                                >
                                                    {" "}
                                                    Día {item.day}{" "}
                                                </span>{" "}
                                                <h3
                                                    class="text-lg md:text-xl font-bold text-slate-800
mb-2"
                                                >
                                                    {" "}
                                                    {item.title}{" "}
                                                </h3>{" "}
                                                <p class="text-slate-600 leading-relaxed text-sm md:text-base whitespace-pre-line">
                                                    {" "}
                                                    {item.description}
                                                </p>{" "}
                                            </div>{" "}
                                        </div>
                                    ))
                                }
                            </div>
                        </div>

                        {/* Hotel Info */}
                        {
                            pkg.hotelInfo && (
                                <div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100">
                                    <h2 class="text-3xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                                        <span class="w-2 h-8 bg-blue-500 rounded-full" />
                                        Información del Hotel
                                    </h2>
                                    <h3 class="text-xl font-bold text-slate-700 mb-2">
                                        {pkg.hotelInfo.name}
                                    </h3>
                                    <p class="text-slate-600 mb-4">
                                        {pkg.hotelInfo.description}
                                    </p>

                                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <h4 class="font-bold text-slate-700 mb-2">
                                                Características:
                                            </h4>
                                            <ul class="list-disc list-inside text-slate-600 space-y-1">
                                                {pkg.hotelInfo.features &&
                                                    pkg.hotelInfo.features.map(
                                                        (feature: string) => (
                                                            <li>{feature}</li>
                                                        ),
                                                    )}
                                            </ul>
                                        </div>
                                        <div>
                                            <h4 class="font-bold text-slate-700 mb-2">
                                                Gastronomía:
                                            </h4>
                                            <p class="text-slate-600">
                                                {pkg.hotelInfo.gastronomy}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            )
                        }

                        {/* Includes & Excludes */}
                        {
                            (pkg.programIncludes || pkg.programExcludes) && (
                                <div class="grid md:grid-cols-2 gap-8">
                                    {/* Includes */}
                                    {pkg.programIncludes && (
                                        <div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100 h-full">
                                            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                                                <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    class="h-6 w-6 text-green-500"
                                                    fill="none"
                                                    viewBox="0 0 24 24"
                                                    stroke="currentColor"
                                                >
                                                    <path
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M5 13l4 4L19 7"
                                                    />
                                                </svg>
                                                El Programa Incluye
                                            </h2>
                                            <ul class="space-y-3">
                                                {pkg.programIncludes.map(
                                                    (item: string) => (
                                                        <li class="flex items-start gap-3 text-slate-600">
                                                            <svg
                                                                xmlns="http://www.w3.org/2000/svg"
                                                                class="h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"
                                                                viewBox="0 0 20 20"
                                                                fill="currentColor"
                                                            >
                                                                <path
                                                                    fill-rule="evenodd"
                                                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                                                    clip-rule="evenodd"
                                                                />
                                                            </svg>
                                                            <span>{item}</span>
                                                        </li>
                                                    ),
                                                )}
                                            </ul>
                                        </div>
                                    )}

                                    {/* Excludes */}
                                    {pkg.programExcludes && (
                                        <div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100 h-full">
                                            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                                                <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    class="h-6 w-6 text-red-500"
                                                    fill="none"
                                                    viewBox="0 0 24 24"
                                                    stroke="currentColor"
                                                >
                                                    <path
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M6 18L18 6M6 6l12 12"
                                                    />
                                                </svg>
                                                No Incluye
                                            </h2>
                                            <ul class="space-y-3">
                                                {pkg.programExcludes.map(
                                                    (item: string) => (
                                                        <li class="flex items-start gap-3 text-slate-600">
                                                            <svg
                                                                xmlns="http://www.w3.org/2000/svg"
                                                                class="h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"
                                                                viewBox="0 0 20 20"
                                                                fill="currentColor"
                                                            >
                                                                <path
                                                                    fill-rule="evenodd"
                                                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                                                                    clip-rule="evenodd"
                                                                />
                                                            </svg>
                                                            <span>{item}</span>
                                                        </li>
                                                    ),
                                                )}
                                            </ul>
                                        </div>
                                    )}
                                </div>
                            )
                        }

                        {/* Conditions */}
                        {
                            pkg.conditions && (
                                <div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100">
                                    <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                                        <span class="w-2 h-8 bg-slate-400 rounded-full" />
                                        Condiciones Generales
                                    </h2>
                                    <ul class="grid gap-3 text-sm text-slate-500">
                                        {pkg.conditions.map(
                                            (condition: string) => (
                                                <li class="flex items-start gap-2">
                                                    <span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-slate-400 flex-shrink-0" />
                                                    {condition}
                                                </li>
                                            ),
                                        )}
                                    </ul>
                                </div>
                            )
                        }
                    </div>
                    {/* Sidebar: Booking & Info */}
                    <div class="lg:col-span-1">
                        <div class="sticky top-32 space-y-8">
                            {/* Summary Card */}
                            <div
                                class="bg-white rounded-3xl p-8 shadow-xl shadow-slate-200/50 border border-slate-100
text-center relative overflow-hidden"
                            >
                                <div
                                    class="absolute top-0 left-0 w-full h-2
bg-gradient-to-r from-secondary to-primary"
                                >
                                </div>
                                <h3
                                    class="text-2xl font-bold
text-slate-800 mb-2"
                                >
                                    {pkg.title}
                                </h3>
                                <p class="text-slate-500 text-sm mb-6">
                                    Paquete Todo Incluido
                                </p>
                                <a
                                    href={`https://wa.me/51996667974?text=Hola Expeditions Group, estoy interesado en el paquete: ${pkg.title}`}
                                    target="_blank"
                                    rel="noopener
noreferrer"
                                    class="flex items-center justify-center gap-2 w-full py-4 bg-tertiary
text-white font-bold text-sm rounded-xl hover:bg-red-700 hover:shadow-lg hover:shadow-tertiary/30
transition-all transform hover:-translate-y-1 group"
                                >
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        width="24"
                                        height="24"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                        class="group-hover:scale-110
transition-transform"
                                    >
                                        <path
                                            d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556
5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236
3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305
1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452
0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941
1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198
0-.52.074-.792.372-.272.297-1.04 1.017-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198
2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085
1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                                        ></path>
                                    </svg> Consultar Disponibilidad
                                </a>
                                <p class="mt-4 text-xs text-slate-400">
                                    Respuesta inmediata por WhatsApp
                                </p>
                            </div>
                            {/* New Gallery Section */}
                            <div
                                class="bg-white rounded-3xl p-6 shadow-sm border border-slate-100"
                            >
                                <h3
                                    class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2"
                                >
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="h-6 w-6 text-secondary"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                                        ></path>
                                    </svg>
                                    Galería
                                </h3>
                                <div class="space-y-4">
                                    {
                                        optimizedItinerary.map(
                                            (item: any) =>
                                                item.image && (
                                                    <div class="group relative h-48 rounded-2xl overflow-hidden shadow-sm cursor-pointer">
                                                        <img
                                                            src={item.image}
                                                            alt={item.title}
                                                            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                                                            loading="lazy"
                                                        />
                                                    </div>
                                                ),
                                        )
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</Layout>
